<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alca-Ride | Área privada ADMINISTRADOR | Gestión de usuarios</title>
    <link rel="stylesheet" href="styles/tablas.css">
    
    <script>
   /*Función para pintar los datos de la tabla usuarios*/
    function llamada(ServletListarUsuarios) {
    	fetch(ServletListarUsuarios)
    	.then(res => res.json())
    	.then(res => pintarResultados(res));
    	
    }
    
    function pintarResultados(datos) {
    	let html = "<table class='datos-clientes'>";
    	
    	 html += "<tr>";
    	    html += "<th>ID USUARIO</th>";
    	    html += "<th>NOMBRE</th>";
    	    html += "<th>APELLIDO 1</th>";
    	    html += "<th>APELLIDO 2</th>";
    	    html += "<th>NOMBRE USUARIO</th>";
    	    html += "<th>TELÉFONO</th>";
    	    html += "<th>EMAIL</th>";
    	    html += "<th>DNI</th>";
    	    html += "<th>CARNET</th>";
    	    html += "<th>DIRECCIÓN</th>";
    	    html += "<th>MODIFICAR</th>";
    	    html += "<th>ELIMINAR</th>";
    	    html += "</tr>";
    	
    	for(var i=0; i<datos.length; i++) {
    		html += `<tr>
    		<td>${datos[i].id_Usuario}</td>
    		<td>${datos[i].nombre}</td>
    		<td>${datos[i].apellido1}</td>
    		<td>${datos[i].apellido2}</td>
    		<td>${datos[i].nombre_Usuario}</td>
    		<td>${datos[i].telefono}</td>
    		<td>${datos[i].email}</td>
    		<td>${datos[i].dni}</td>
    		<td>${datos[i].carnet}</td>
    		<td>${datos[i].direccion}</td>
    		<td><a href='formUsuarioModif.html?id_Usuario=${datos[i].id_Usuario}'><button type="submit">Modificar</button></a></td>
    		<td>   	 	
    	   		<form
    	   			onsubmit="return confirmarEliminacion();" action="ServletEliminarUsuario" method="post">
	    	    	<input type="hidden" name="id_Usuario" value="${datos[i].id_Usuario}">
	    	    	<button type="submit">Eliminar</button>
    	 		</form>
    		</td>
    		</tr>`;
    	}
    	
    	html += "</table>";
    	
    	document.getElementById("listadoUsuarios").innerHTML = html;
    }
    

    
    window.onload = function() {
        llamada("ServletListarUsuarios");
    }
    
    //Función para confirmar la eliminación del registro
    function confirmarEliminacion() {
        return confirm("¿Estás seguro que quieres eliminar el registro?");
    }

 	// Obtiene el mensaje del servidor (de la URL)
    var mensaje = new URLSearchParams(window.location.search).get("mensaje");

    // Si hay un mensaje, muestra una ventana emergente con él
    if (mensaje) {
        alert(mensaje);
    }
    
    </script>
    
</head>

  <!-- Creo una clase para el body, para la cual aplicaré 
    en su página de estilos un grid y le daré forma responsive.
    Divido el body en 4 apartados principales:
        header
        navbar
        contenido
        footer
    -->
<body class="gridContainer">

    <header class="header">
        <!--Pongo este div para que el enlace se ajuste exactamente al logo-->
        <div>
        <a href="index.html"><img src="images/logo1.jpg" alt="Logo Alca-Ride"></a>
        </div>
    </header>

    <nav class="navbar">
        <a href="index.html">Inicio</a>
        <a href="catalogo.html">Catálogo</a>
        <a href="condic.html">Condiciones</a>
        <a href="contacto.html">Contacto</a>
        <a href="login.html">Iniciar Sesión</a>
    </nav>
    
    <article class="contenido">

        <div class="menu">
            
            <div class="adm"><a href="adminArea.html">ADMINISTRADOR</a></div>
            <div class="usu"><a href="adminUsu.html">Gestión de usuarios</a></div>
            <div class="res"><a href="adminRes.html">Gestión de reservas</a></div>
            <div class="pro"><a href="adminPro.html">Gestión de productos</a></div>
        </div>
        
        <h1>Tabla Usuarios Registrados</h1>
        
          <div id="listadoUsuarios"></div>
          
    </article>

    <footer class="footer">
        <a href="privacidad.html" style="color: white;">Política de privacidad</a>
        <a href="legal.html" style="color: white;">Aviso legal</a>
        <p style="color: white;">Copyright Alca-Ride 2024 - Developed by Daniel Fernández</p>
    </footer>

</body>

</html>